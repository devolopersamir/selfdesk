<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>রেজাল্ট সিস্টেম</title>
  <link href="https://fonts.maateen.me/solaiman-lipi/font.css" rel="stylesheet" />
  <style>
    body {
      font-family: 'SolaimanLipi', sans-serif;
      background-color: #f0f0f0;
      padding: 20px;
    }
    .box {
      background: white;
      padding: 20px;
      border-radius: 8px;
      max-width: 500px;
      margin: 10px auto;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    input, textarea, button {
      font-family: 'SolaimanLipi', sans-serif;
      width: 100%;
      padding: 8px;
      margin: 5px 0;
      font-size: 16px;
    }
    .admin-box {
      display: none;
    }
  </style>
</head>
<body>

  <div class="box">
    <h2>স্টুডেন্ট রেজাল্ট দেখুন</h2>
    <input type="text" id="studentRoll" placeholder="রোল নম্বর লিখুন">
    <button onclick="searchResult()">রেজাল্ট দেখুন</button>
    <div id="studentResult"></div>
  </div>

  <div class="box">
    <h2>এডমিন লগইন</h2>
    <input type="password" id="adminPass" placeholder="এডমিন পাসওয়ার্ড">
    <button onclick="adminLogin()">লগইন করুন</button>
  </div>

  <div class="box admin-box" id="adminPanel">
    <h2>রেজাল্ট এন্ট্রি / আপডেট</h2>
    <input type="text" id="roll" placeholder="রোল নম্বর">
    <input type="text" id="name" placeholder="নাম">
    <input type="number" id="marks" placeholder="মোট নম্বর">
    <input type="number" id="answers" placeholder="মোট উত্তর">
    <input type="text" id="status" placeholder="স্টেটাস (নির্বাচিত/বাতিল)">
    <textarea id="note" placeholder="নোট"></textarea>
    <button onclick="saveResult()">সংরক্ষণ করুন</button>
    <button onclick="deleteResult()">রেজাল্ট ডিলিট করুন</button>
  </div>

  <script type="module">
    // Firebase Import
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, doc, setDoc, getDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    // Firebase Config
    const firebaseConfig = {
      apiKey: "AIzaSyD5iO7SbmpoATuwyFDNqxsya6vKRjsMhrg",
      authDomain: "selfresult-15db7.firebaseapp.com",
      projectId: "selfresult-15db7",
      storageBucket: "selfresult-15db7.firebasestorage.app",
      messagingSenderId: "911415974286",
      appId: "1:911415974286:web:93e2d836baeb9095b9acdf",
      measurementId: "G-VPB0C5D2BV"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Student Result Search
    async function searchResult() {
      const roll = document.getElementById("studentRoll").value;
      const resultBox = document.getElementById("studentResult");
      const docRef = doc(db, "results", roll);
      const docSnap = await getDoc(docRef);

      if (docSnap.exists()) {
        const data = docSnap.data();
        resultBox.innerHTML = `
          <p><strong>নাম:</strong> ${data.name}</p>
          <p><strong>মোট নম্বর:</strong> ${data.totalMarks}</p>
          <p><strong>মোট উত্তর:</strong> ${data.totalAnswers}</p>
          <p><strong>স্টেটাস:</strong> ${data.status}</p>
          <p><strong>নোট:</strong> ${data.note}</p>
        `;
      } else {
        resultBox.innerHTML = "<p>রেজাল্ট পাওয়া যায়নি।</p>";
      }
    }

    // Admin Login
    function adminLogin() {
      const pass = document.getElementById("adminPass").value;
      if (pass === "123456") {
        document.getElementById("adminPanel").style.display = "block";
        alert("লগইন সফল!");
      } else {
        alert("ভুল পাসওয়ার্ড!");
      }
    }

    // Save or Update Result
    async function saveResult() {
      const roll = document.getElementById("roll").value;
      const name = document.getElementById("name").value;
      const totalMarks = parseInt(document.getElementById("marks").value);
      const totalAnswers = parseInt(document.getElementById("answers").value);
      const status = document.getElementById("status").value;
      const note = document.getElementById("note").value;

      await setDoc(doc(db, "results", roll), {
        name, totalMarks, totalAnswers, status, note
      });

      alert("রেজাল্ট সংরক্ষণ/আপডেট সফল হয়েছে!");
    }

    // Delete Result
    async function deleteResult() {
      const roll = document.getElementById("roll").value;
      await deleteDoc(doc(db, "results", roll));
      alert("রেজাল্ট ডিলিট হয়েছে!");
    }
  </script>

</body>
</html>
